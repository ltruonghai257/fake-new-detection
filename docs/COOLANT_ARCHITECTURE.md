# COOLANT Architecture Diagram

## Overview
COOLANT (Cross-modal Contrastive Learning for Multimodal Fake News Detection) is a sophisticated multimodal architecture that combines text and image processing with cross-modal learning mechanisms.

## High-Level Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                    COOLANT MODEL                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │   Text Input    │    │  Image Input    │                                    │
│  │  (B, 30, 200)   │    │   (B, 512)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        Similarity Module                                │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Aligned    │    │ Image Aligned   │                                    │
│  │   (B, 64)       │    │    (B, 64)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            └──────────┬───────────┘                                            │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                      Detection Module                                   │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                  Final Classification                                   │    │
│  │                   (B, 2) - [Real/Fake]                                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Detailed Module Architecture

### 1. Similarity Module

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Similarity Module                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │   Text Raw      │    │  Image Raw      │                                    │
│  │  (B, 30, 200)   │    │   (B, 512)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                         Encoding Part                                   │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ FastCNN     │    │ Text Linear │    │ Image Linear│                  │    │
│  │  │ (B,30,200)  │    │  (B,128)    │    │  (B,128)    │                  │    │
│  │  │ → (B,128)   │    │ → (B,128)   │    │ → (B,128)   │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Shared     │    │ Image Shared    │                                    │
│  │   (B, 128)      │    │    (B, 128)     │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Aligner    │    │ Image Aligner   │                                    │
│  │  (B,128)→(B,64) │    │ (B,128)→(B,64)  │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Aligned    │    │ Image Aligned   │                                    │
│  │    (B, 64)      │    │    (B, 64)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            └──────────┬───────────┘                                            │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                 Similarity Classifier                                    │    │
│  │                 Concat([Text, Image]) → (B,128) → (B,2)                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 2. Detection Module

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Detection Module                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │   Text Raw      │    │  Image Raw      │                                    │
│  │  (B, 30, 200)   │    │   (B, 512)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                         Encoding Part                                   │    │
│  │  → Text Prime (B,128) → Image Prime (B,128)                            │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    Unimodal Detection                                   │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ Text Uni    │    │ Image Uni   │    │ Text Uni SE │                  │    │
│  │  │ (B,128)→16  │    │ (B,128)→16  │    │ (B,128)→64  │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ Image Uni SE│    │ Text Prime  │    │ Image Prime │                  │    │
│  │  │ (B,128)→64  │    │ (B,16)      │    │ (B,16)      │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Prime      │    │ Image Prime     │                                    │
│  │    (B, 16)      │    │    (B, 16)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            └──────────┬───────────┘                                            │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                   Cross Module 4 Batch                                  │    │
│  │  Text (B,16) × Image (B,16) → Correlation (B,64)                       │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        SE Attention Module                              │    │
│  │  Input: Text SE (B,64), Image SE (B,64), Correlation (B,64)             │    │
│  │  Output: Attention Weights (B,3) - [text, image, correlation]           │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                      Attention Application                               │    │
│  │  Text Final = Text Prime × attention[:,0]                               │    │
│  │  Image Final = Image Prime × attention[:,1]                             │    │
│  │  Correlation Final = Correlation × attention[:,2]                       │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    Feature Concatenation                                │    │
│  │  Concat([Text Final, Image Final, Correlation Final]) → (B,96)          │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    Final Classifier                                      │    │
│  │  (B,96) → (B,64) → (B,64) → (B,2) - [Real/Fake]                        │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 3. Ambiguity Learning Module

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        Ambiguity Learning                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Aligned    │    │ Image Aligned   │                                    │
│  │    (B, 64)      │    │    (B, 64)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                           Encoders                                       │    │
│  │  ┌─────────────┐    ┌─────────────┐                                      │    │
│  │  │ Text Encoder│    │Image Encoder│                                      │    │
│  │  │ (B,64)→(B,4)│    │(B,64)→(B,4) │                                      │    │
│  │  └─────────────┘    └─────────────┘                                      │    │
│  │  ┌─────────────┐    ┌─────────────┐                                      │    │
│  │  │ μ₁, σ₁      │    │ μ₂, σ₂      │                                      │    │
│  │  │ (B,2) each  │    │ (B,2) each  │                                      │    │
│  │  └─────────────┘    └─────────────┘                                      │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ z₁ ~ N(μ₁,σ₁)   │    │ z₂ ~ N(μ₂,σ₂)   │                                    │
│  │    (B, 2)       │    │    (B, 2)       │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            └──────────┬───────────┘                                            │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                 Symmetric KL Divergence                                  │    │
│  │  SKL = (KL(p(z₁|text)‖p(z₁|image)) + KL(p(z₂|image)‖p(z₂|text))) / 2    │    │
│  │  Output: (B,) - Ambiguity Score                                          │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    Weight Computation                                     │    │
│  │  weight_uni = (1 - SKL)  → Unimodal weight                               │    │
│  │  weight_corre = SKL      → Correlation weight                            │    │
│  │  Output: [weight_uni, weight_uni, weight_corre] for [text, image, corr]  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Complete Data Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            COMPLETE DATA FLOW                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  INPUTS:                                                                       │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Features   │    │ Image Features  │                                    │
│  │   (B, 768)      │    │   (B, 512)      │                                    │
│  │     ↓           │    │      ↓          │                                    │
│  │  Reshape to     │    │   Pass through  │                                    │
│  │  (B, 30, 200)   │    │   Directly     │                                    │
│  └─────────────────┘    └─────────────────┘                                    │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                           SIMILARITY MODULE                              │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ Encoding    │    │ Alignment   │    │ Similarity  │                  │    │
│  │  │ Part        │    │ Networks    │    │ Classifier  │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│            │                      │                                            │
│            ▼                      ▼                                            │
│  ┌─────────────────┐    ┌─────────────────┐                                    │
│  │ Text Aligned    │    │ Image Aligned   │                                    │
│  │    (B, 64)      │    │    (B, 64)      │                                    │
│  └─────────┬───────┘    └─────────┬───────┘                                    │
│            │                      │                                            │
│            └──────────┬───────────┘                                            │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                           DETECTION MODULE                               │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ Encoding    │    │ Unimodal    │    │ Cross       │                  │    │
│  │  │ Part        │    │ Detection   │    │ Module      │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ SE          │    │ Attention   │    │ Final       │                  │    │
│  │  │ Attention   │    │ Application │    │ Classifier  │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        AMBIGUITY LEARNING                                │    │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                  │    │
│  │  │ Variational │    │ Symmetric   │    │ Weight      │                  │    │
│  │  │ Encoders    │    │ KL Div      │    │ Computation │                  │    │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  OUTPUTS:                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │  Classification Logits: (B, 2) - [Real/Fake]                            │    │
│  │  Attention Weights: (B, 3) - [text, image, correlation]                │    │
│  │  Ambiguity Weights: (B, 3) - [uni, uni, correlation]                   │    │
│  │  Similarity Prediction: (B, 2) - [Similar/Dissimilar]                  │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Loss Components

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              LOSS COMPONENTS                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    CLASSIFICATION LOSS                                   │    │
│  │  CrossEntropy( logits, labels )                                          │    │
│  │  Weight: classification_weight (default: 1.0)                            │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                   CONTRASTIVE LOSS                                       │    │
│  │  InfoNCE Loss between text and image features                           │    │
│  │  L = -(log(sim(x_i,y_i)/Σ_j sim(x_i,y_j)))                              │    │
│  │  Weight: contrastive_weight (default: 1.0)                              │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    SIMILARITY LOSS                                       │    │
│  │  CrossEntropy( similarity_pred, similarity_labels )                     │    │
│  │  Weight: similarity_weight (default: 0.5)                               │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
│                       │                                                        │
│                       ▼                                                        │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        TOTAL LOSS                                         │    │
│  │  Total = cls_weight × cls_loss + cont_weight × cont_loss                │    │
│  │         + sim_weight × sim_loss                                           │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Key Features

1. **Cross-modal Contrastive Learning**: Learns alignment between text and image modalities
2. **Ambiguity Learning**: Uses variational inference to model cross-modal uncertainty
3. **SE Attention Mechanism**: Squeeze-and-Excitation attention for feature weighting
4. **Multi-component Loss**: Combines classification, contrastive, and similarity losses
5. **Hierarchical Processing**: Multiple levels of feature extraction and fusion

## Model Parameters

- **Text Input**: (batch_size, 30, 200) - CNN-friendly sequence format
- **Image Input**: (batch_size, 512) - Pre-extracted image features
- **Shared Dimension**: 128 - Cross-modal shared representation size
- **Similarity Dimension**: 64 - Aligned feature dimension
- **Final Feature Dim**: 96 - Concatenated features (16+16+64)
- **Output Classes**: 2 - [Real News, Fake News]

This architecture enables sophisticated multimodal fake news detection through cross-modal learning, attention mechanisms, and uncertainty modeling!
